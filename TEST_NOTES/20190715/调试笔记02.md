# 调试笔记02
发现了一些问题，先记录如下：

1. **Q：**板子带电烧录程序，结果程序偶尔烧录失败，甚至直接在烧录过程中报错  
**A：**板子的5V和电机驱动的VCC相连，用电脑串口给板子上电，电机不接电池就可以转动。**这样做是有隐患的**，可能会导致芯片闪存擦除写入失败。正确的做法是烧录的过程断开板子连接的所有元件，最起码的也要将板子的5V断开。

## 调参过程  
1. 利用final_v2，读取陀螺仪数据，找到短暂平衡的点。记录为-2左右。
2. 更改机械中值，将直立环的kd，速度环的kp、kd，转向环的kp、kd均置零，只调整直立环的kp
    + kp=10，小车平稳运行，不抖动，短暂直立
    + kp=15，小车较为平稳，直立2-3秒
    + kp=20，小车往两边行驶都抖动剧烈，直立很难完成
    + kp=18，同上，抖动程度减轻，但直立仍然很难
    + kp=16，行驶平稳，直立2-3秒
    + kp=17，出现抖动
于是确定kp满辐为17。
3. 接下来调整kd。kd值一般在0~2之间。
    + kd=0.1，小车仍然**大幅度低频**抖动
    + kd=0.3，同上
    + kd=0.5，同上
    + kd=0.7，同上
    + kd=0.9，小车开始高频抖动，立即断电
    + kd=0.8，高频抖动。
由此kd确定为0.8
4. 将直立环的kp,kd乘0.6，确定最终的kp=11,kd=0.5
5. 直立环参数置零，设速度环的kp=2,ki=0.01（正），发现可以跟随。说明极性设置正确。
6. 直立环改回来。
    + 速度环参数不变，发现小车较为平稳，且可以直立。
    + kp=1,ki=0.005，仍有抖动，小车不能直立。
    + kp=4,ki=0.02，平稳运行，但加入人为干扰就反应强烈，故不可取。
